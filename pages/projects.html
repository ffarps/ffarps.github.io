<!DOCTYPE html>
<html lang="en-GB" id="html-root">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title id="page-title">All Projects</title>
    <link rel="stylesheet" href="/styles/styles.min.css" />
    <style>
        main {
            flex: 1;
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem 3rem;
            box-sizing: border-box;
        }

        .page-header {
            margin-bottom: 2.5rem;
        }

        .page-navigation {
            margin-bottom: 1rem;
        }

        .back-button {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.6rem 1rem;
            border-radius: 6px;
            border: 1px solid var(--accent-color);
            background: transparent;
            color: var(--font-color);
            text-decoration: none;
            font-weight: 600;
            font-size: 1em; /* Medium - Back button */
            transition: all 0.2s ease;
            width: fit-content;
        }

        .back-button:hover,
        .back-button:focus-visible {
            background: var(--accent-color);
            color: var(--back-accent-color);
        }

        .back-button:focus-visible {
            outline: 2px solid var(--font-color);
            outline-offset: 2px;
        }

        .back-arrow {
            font-size: 16px;
            font-weight: bold;
            transition: color 0.2s ease;
        }

        .back-button:hover .back-arrow,
        .back-button:focus-visible .back-arrow {
            color: var(--back-accent-color);
        }

        .page-header h1 {
            margin-bottom: 0.75rem;
            font-size: 2em; /* Large - Page title */
        }

        .page-header p {
            max-width: 60ch;
            line-height: 1.6;
            font-size: 1em; /* Medium - Description */
        }

        .projects-toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 1.25rem;
            align-items: flex-end;
            margin-bottom: 2rem;
        }

        .toolbar-field {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            min-width: 220px;
            flex: 1 1 280px;
        }

        .toolbar-field label {
            font-size: 1em; /* Medium - Labels */
            font-weight: 600;
            opacity: 0.8;
        }

        .search-input {
            width: 100%;
            padding: 0.65rem 0.95rem;
            border: 2px solid var(--accent-color);
            border-radius: 8px;
            background: var(--back-accent-color);
            color: var(--font-color);
            font-size: 1em; /* Medium - Input text */
            transition: border-color 0.2s ease;
        }

        .search-input:focus-visible {
            outline: 2px solid var(--font-color);
            outline-offset: 2px;
        }

        .sort-select {
            width: 100%;
            padding: 0.65rem 0.95rem;
            border: 2px solid var(--accent-color);
            border-radius: 8px;
            background: var(--back-accent-color);
            color: var(--font-color);
            font-size: 1em; /* Medium - Select text */
            appearance: none;
        }

        .chips-container {
            flex: 100%;
            display: flex;
            flex-direction: column;
            gap: 0.65rem;
        }

        .chip-row {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .tag-chip {
            border: 1px solid var(--accent-color);
            border-radius: 999px;
            padding: 0.35rem 0.75rem;
            font-size: 0.85em; /* Small - Tag chips */
            font-weight: 600;
            background: transparent;
            color: var(--font-color);
            cursor: pointer;
            transition: background 0.2s ease, color 0.2s ease, border-color 0.2s ease;
        }

        .tag-chip[aria-pressed="true"] {
            background: var(--accent-color);
            color: var(--back-accent-color);
            border-color: transparent;
        }

        .tag-chip:focus-visible {
            outline: 2px solid var(--font-color);
            outline-offset: 2px;
        }

        .toolbar-actions {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .toolbar-actions button {
            padding: 0.6rem 1rem;
            border-radius: 6px;
            border: 1px solid var(--accent-color);
            background: transparent;
            color: var(--font-color);
            font-weight: 600;
            font-size: 1em; /* Medium - Buttons */
            cursor: pointer;
            transition: background 0.2s ease, color 0.2s ease, border-color 0.2s ease;
        }

        .toolbar-actions button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .toolbar-actions button:not(:disabled):hover,
        .toolbar-actions button:not(:disabled):focus-visible {
            background: var(--accent-color);
            color: var(--back-accent-color);
        }

        .results-summary {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .results-summary {
            font-size: 1em; /* Medium - Summary text */
        }

        .results-summary strong {
            font-size: 1em; /* Medium - Summary count */
        }

        .project-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, max-content));
            gap: 0.75rem;
            margin-bottom: 3rem;
            align-items: start;
            justify-content: start;
        }

        .project-card {
            background: var(--back-accent-color);
            border: 1px solid var(--accent-color);
            border-radius: 6px;
            padding: 0.75rem;
            display: flex;
            flex-direction: column;
            gap: 0.4rem;
            position: relative;
            cursor: pointer;
            min-height: 200px;
        }

        .project-card:focus-within {
            outline: 2px solid var(--font-color);
            outline-offset: 4px;
        }
        
        .project-card:hover {
            background: var(--accent-color);
            color: var(--back-accent-color);
        }
        
        .project-card:hover h3,
        .project-card:hover p,
        .project-card:hover .project-meta,
        .project-card:hover .project-meta span {
            color: var(--back-accent-color);
        }
        
        .project-card:hover .project-tags li {
            color: var(--back-accent-color) !important;
            border-color: var(--back-accent-color) !important;
        }

        .project-card h3 {
            margin: 0;
            font-size: 1em; /* Medium - Card titles */
            line-height: 1.3;
            font-weight: 600;
        }

        .project-card p {
            margin: 0;
            opacity: 0.85;
            line-height: 1.4;
            font-size: 1em; /* Medium - Card descriptions */
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
            flex: 1;
        }

        .project-meta {
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 0.85em; /* Small - Meta text */
            opacity: 0.7;
        }

        .project-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.3rem;
            margin: 0;
            padding: 0;
            list-style: none;
        }

        .project-tags li {
            border-radius: 999px;
            padding: 0.2rem 0.5rem;
            font-size: 0.85em; /* Small - Tag labels */
            font-weight: 600;
            border: 1px solid currentColor;
        }
        
        .project-tags li[data-tag="Template"] {
            background: var(--accent-color);
            color: var(--back-accent-color);
            border-color: var(--accent-color);
        }

        .project-link {
            display: none !important;
        }

        .empty-state {
            padding: 2.5rem;
            border-radius: 16px;
            border: 2px dashed var(--accent-color);
            text-align: center;
            font-style: italic;
            opacity: 0.8;
            font-size: 1em; /* Medium - Empty state text */
        }


        @media (max-width: 720px) {
            main {
                padding: 1.5rem 1rem;
            }

            .project-grid {
                grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
                gap: 0.6rem;
            }

            .project-card {
                padding: 0.6rem;
            }
            
            .project-card p {
                flex: 1;
            }
            
            .project-tags {
                min-height: 24px;
            }

            .projects-toolbar {
                gap: 1rem;
            }

            .toolbar-field {
                flex: 1 1 100%;
            }

            .results-summary {
                flex-direction: column;
                align-items: flex-start;
            }

            .back-button {
                padding: 0.5rem 0.8rem;
                font-size: 0.9rem;
            }
            
            .back-button-text {
                display: none;
            }
            
            .back-button {
                width: auto;
            }
        }

        /* Modal styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 1rem;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: var(--back-accent-color);
            border: 2px solid var(--accent-color);
            border-radius: 16px;
            max-width: 1200px;
            width: 95%;
            max-height: 95vh;
            overflow-y: auto;
            padding: 3rem;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 2rem;
        }

        .modal-title {
            font-size: 2em; /* Large - Modal title */
            margin: 0;
            line-height: 1.3;
            flex: 1;
            padding-right: 1rem;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 2em; /* Large - Close button */
            cursor: pointer;
            color: var(--font-color);
            padding: 0;
            width: 2rem;
            height: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.2s ease;
        }

        .modal-close:hover {
            background: var(--accent-color);
            color: var(--back-accent-color);
        }

        .modal-section {
            margin-bottom: 2.5rem;
            font-size: 1em; /* Medium - Modal section text */
        }

        .modal-section h3 {
            font-size: 1.2em; /* Slightly larger - Modal section headings */
            margin-bottom: 1.2rem;
            color: var(--accent-color);
            font-weight: 600;
        }

        .modal-section p {
            line-height: 1.6;
            margin: 0;
        }

        .modal-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .modal-list li {
            padding: 0.6rem 0;
            padding-left: 2rem;
            position: relative;
            line-height: 1.5;
        }

        .modal-list li:before {
            content: "→";
            position: absolute;
            left: 0;
            color: var(--accent-color);
            font-weight: bold;
        }

        .modal-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2.5rem;
            flex-wrap: wrap;
        }

        .modal-btn {
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            border: 2px solid var(--accent-color);
            background: transparent;
            color: var(--font-color);
            font-weight: 600;
            font-size: 1em; /* Medium - Modal buttons */
            cursor: pointer;
            transition: background 0.2s ease, color 0.2s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .modal-btn:hover {
            background: var(--accent-color);
            color: var(--back-accent-color);
        }

        .modal-btn.primary {
            background: var(--accent-color);
            color: var(--back-accent-color);
        }

        .modal-btn.primary:hover {
            background: transparent;
            color: var(--font-color);
        }

        @media (max-width: 720px) {
            .modal {
                padding: 1.5rem;
            }
            
            .modal-title {
                font-size: 2em; /* Large - Mobile modal title */
            }
            
            .modal-actions {
                flex-direction: column;
            }
        }
    </style>
</head>

<main>
    <header class="page-header">
        <div class="page-navigation">
            <a href="/" class="back-button" aria-label="Go back to homepage">
                <span class="back-arrow" aria-hidden="true">←</span>
                <span class="back-button-text" id="back-button-text">Back to Home</span>
            </a>
        </div>
        <h1 id="projects-title">All Projects</h1>
        <p id="projects-description">Browse Francisco Pereira&rsquo;s full portfolio. Use the search bar and tag filters to quickly surface work
            by technology, industry, or platform.</p>
    </header>

    <section aria-labelledby="projects-title">
        <h2 class="sr-only">Projects catalogue</h2>

        <div class="projects-toolbar">
            <div class="toolbar-field">
                <label for="search-input" id="search-label">Search</label>
                <input id="search-input" class="search-input" type="search" id="search-placeholder"
                    autocomplete="off" />
            </div>

            <div class="toolbar-field">
                <label for="sort-select" id="sort-label">Sort by</label>
                <select id="sort-select" class="sort-select">
                    <option value="featured" id="sort-featured">Featured order</option>
                    <option value="newest" id="sort-newest">Newest first</option>
                    <option value="title-asc" id="sort-title">Title A &rarr; Z</option>
                </select>
            </div>

            <div class="chips-container">
                <span class="tag-label" id="tag-filter-label">Filter by tag</span>
                <div class="chip-row" id="tag-chip-row" role="group" aria-labelledby="tag-filter-label"></div>
            </div>

            <div class="toolbar-actions">
                <button type="button" id="clear-filters" disabled id="clear-filters-text">Clear filters</button>
            </div>
        </div>

        <div class="results-summary" aria-live="polite" aria-atomic="true">
            <strong id="results-count"></strong>
            <span id="results-active-filters"></span>
        </div>

        <div id="projects-grid" class="project-grid" role="list"></div>
    </section>
</main>

    <!-- Project Detail Modal -->
    <div id="project-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="modal-title">
        <div class="modal">
            <div class="modal-header">
                <h2 id="modal-title" class="modal-title"></h2>
                <button id="modal-close" class="modal-close" aria-label="Close modal">&times;</button>
            </div>
            <div id="modal-content">
                <!-- Content will be dynamically inserted here -->
            </div>
        </div>
    </div>

<footer class="footer">
    <div class="footer-main central-footer-content">
        <div class="footer-row">
            <div class="footer-links">
                <a href="/pages/privacy.html" class="footer-link">Privacy</a>
            </div>
            <div class="footer-social">
                <a class="primary" href="https://github.com/ffarps" title="GitHub" target="_blank" rel="noopener noreferrer">
                    <svg width="20" height="20" aria-hidden="true">
                        <use href="/images/icons.svg#github-icon"></use>
                    </svg>
                </a>
                <a class="primary linkedin-icon" href="https://www.linkedin.com/in/francisco-pereira-9755501a3/"
                    title="LinkedIn" target="_blank" rel="noopener noreferrer">
                    <svg width="20" height="20" aria-hidden="true">
                        <use href="/images/icons.svg#linkedin-icon"></use>
                    </svg>
                </a>
            </div>
            <div class="footer-switchers">
                <div id="lang-switcher" class="lang-switcher lang-switcher-footer stylish-lang-switcher">
                    <button class="lang-btn" data-lang="en-GB" aria-label="English" title="English" tabindex="0">
                        <span class="lang-flag-wrap"><img loading="lazy" src="/images/gb.svg" alt="English" height="22" width="32" /></span>
                        <span class="lang-label">EN</span>
                    </button>
                    <button class="lang-btn" data-lang="pt-PT" aria-label="Português" title="Português" tabindex="0">
                        <span class="lang-flag-wrap"><img loading="lazy" src="/images/pt.svg" alt="Português" height="22" width="32" /></span>
                        <span class="lang-label">PT</span>
                    </button>
                </div>
                <div id="theme-switcher" class="theme-switcher">
                    <button class="theme-btn" data-theme="system" aria-label="System Default" title="System Default">
                        System
                    </button>
                    <button class="theme-btn" data-theme="dark" aria-label="Dark Mode" title="Dark Mode">
                        Dark
                    </button>
                    <button class="theme-btn" data-theme="light" aria-label="Light Mode" title="Light Mode">
                        Light
                    </button>
                </div>
            </div>
        </div>
        <span class="footer-copyright">&copy; 2023-2025 Francisco Pereira</span>
    </div>
</footer>

    <script>
        window.addEventListener("DOMContentLoaded", () => {
            let projectsData = null;
            let uiTexts = null;
            let currentLang = localStorage.getItem('lang') || 'en-GB';

            const state = {
                search: "",
                tags: new Set(),
                sort: "featured"
            };

            const elements = {
                grid: document.getElementById("projects-grid"),
                tagRow: document.getElementById("tag-chip-row"),
                search: document.getElementById("search-input"),
                sort: document.getElementById("sort-select"),
                clear: document.getElementById("clear-filters"),
                resultsCount: document.getElementById("results-count"),
                resultsFilters: document.getElementById("results-active-filters")
            };

            // Load projects data from JSON
            fetch('/pages/projects/content.json')
                .then(response => response.json())
                .then(data => {
                    projectsData = data.projects;
                    uiTexts = data.ui;
                    initializeApp();
                })
                .catch(error => {
                    console.error('Error loading projects data:', error);
                    // Fallback to hardcoded data if JSON fails to load
                    projectsData = [
                        {
                            id: "holoassembly",
                            title: "HoloAssembly",
                            description: "AR/VR simulator that guides technicians through complex assembly workflows.",
                            link: "https://github.com/ffarps/holoassembly",
                            tags: ["Simulation", "Tools", "XR"],
                            primaryTag: "Simulation",
                            year: 2024,
                            featuredOrder: 1,
                            external: true
                        }
                    ];
                    initializeApp();
                });

            function initializeApp() {
                if (!projectsData) return;

                // Set language
                document.getElementById('html-root').setAttribute('lang', currentLang);
                updateUITexts();
                
                // Initialize the rest of the app
                const uniqueTags = Array.from(new Set(projectsData.flatMap(project => project.tags))).sort((a, b) => a.localeCompare(b));
                
                function getColorForTag(tag) {
                    const accent = getComputedStyle(document.documentElement).getPropertyValue("--accent-color").trim();
                    let hash = 0;
                    for (let i = 0; i < tag.length; i += 1) {
                        hash = tag.charCodeAt(i) + ((hash << 5) - hash);
                    }
                    const hue = Math.abs(hash) % 360;
                    return accent || `hsl(${hue}, 70%, 55%)`;
                }

                function buildTagFilters() {
                    elements.tagRow.innerHTML = "";
                    uniqueTags.forEach(tag => {
                        const button = document.createElement("button");
                        button.type = "button";
                        button.className = "tag-chip";
                        button.textContent = tag;
                        button.dataset.tag = tag;
                        button.setAttribute("aria-pressed", state.tags.has(tag) ? "true" : "false");
                        button.addEventListener("click", () => toggleTag(tag));
                        elements.tagRow.appendChild(button);
                    });
                }

                function toggleTag(tag) {
                    if (state.tags.has(tag)) {
                        state.tags.delete(tag);
                    } else {
                        state.tags.add(tag);
                    }
                    render();
                }

                function handleSearch(event) {
                    state.search = event.target.value;
                    render();
                }

                function handleSort(event) {
                    state.sort = event.target.value;
                    render();
                }

                function clearFilters() {
                    state.search = "";
                    state.tags.clear();
                    state.sort = "featured";
                    render();
                }

                function getFilteredProjects() {
                    const query = state.search.trim().toLowerCase();
                    const activeTags = Array.from(state.tags);

                    return projectsData
                        .filter(project => {
                            const projectContent = project.content[currentLang] || project.content['en-GB'];
                            const matchesSearch = query.length === 0
                                || projectContent.title.toLowerCase().includes(query)
                                || projectContent.description.toLowerCase().includes(query)
                                || project.tags.some(tag => tag.toLowerCase().includes(query));

                            const matchesTags = activeTags.length === 0
                                ? true
                                : activeTags.every(tag => project.tags.includes(tag));

                            return matchesSearch && matchesTags;
                        })
                        .sort((a, b) => {
                            if (state.sort === "newest") {
                                // Sort by year and month
                                const dateA = a.year * 12 + (a.month || 0);
                                const dateB = b.year * 12 + (b.month || 0);
                                return dateB - dateA; // Higher value = more recent
                            }
                            if (state.sort === "title-asc") {
                                const titleA = (a.content[currentLang] || a.content['en-GB']).title;
                                const titleB = (b.content[currentLang] || b.content['en-GB']).title;
                                return titleA.localeCompare(titleB);
                            }
                            return a.featuredOrder - b.featuredOrder;
                        });
                }

                function renderProjects() {
                    const filtered = getFilteredProjects();
                    elements.grid.innerHTML = "";

                    if (filtered.length === 0) {
                        const empty = document.createElement("div");
                        empty.className = "empty-state";
                        empty.textContent = uiTexts[currentLang].no_projects;
                        elements.grid.appendChild(empty);
                        return;
                    }

                    filtered.forEach(project => {
                        const projectContent = project.content[currentLang] || project.content['en-GB'];
                        const card = document.createElement("article");
                        card.className = "project-card";
                        card.setAttribute("role", "listitem");

                        const title = document.createElement("h3");
                        title.textContent = projectContent.title;

                        const description = document.createElement("p");
                        description.textContent = projectContent.description;

                        const meta = document.createElement("div");
                        meta.className = "project-meta";
                        meta.innerHTML = `<span>${project.primaryTag}</span><span>${project.year}</span>`;

                        const tagList = document.createElement("ul");
                        tagList.className = "project-tags";
                        project.tags.forEach(tag => {
                            const item = document.createElement("li");
                            item.textContent = tag;
                            item.setAttribute("data-tag", tag);
                            if (tag !== "Template") {
                                item.style.color = getColorForTag(tag);
                            }
                            tagList.appendChild(item);
                        });

                        const link = document.createElement("a");
                        link.className = "project-link";
                        
                        if (project.external) {
                            link.href = project.link;
                            link.target = "_blank";
                            link.rel = "noopener noreferrer";
                        } else {
                            link.href = "#";
                            link.addEventListener("click", (e) => {
                                e.preventDefault();
                                showProjectDetail(project);
                            });
                        }
                        
                        link.innerHTML = `${uiTexts[currentLang].explore}<span aria-hidden="true">→</span>`;

                        // Make entire card clickable
                        card.addEventListener("click", (e) => {
                            // Don't trigger if clicking on the link itself
                            if (!e.target.closest('.project-link')) {
                                if (project.external) {
                                    window.open(project.link, '_blank', 'noopener,noreferrer');
                                } else {
                                    showProjectDetail(project);
                                }
                            }
                        });

                        card.appendChild(title);
                        card.appendChild(description);
                        card.appendChild(meta);
                        card.appendChild(tagList);
                        card.appendChild(link);
                        elements.grid.appendChild(card);
                    });

                    updateSummary(filtered.length);
                }

                function updateSummary(visibleCount) {
                    const total = projectsData.length;
                    const tagDescription = state.tags.size > 0
                        ? uiTexts[currentLang].filtered_by.replace('{tags}', Array.from(state.tags).join(", "))
                        : uiTexts[currentLang].no_filters;

                    elements.resultsCount.textContent = uiTexts[currentLang].showing_results
                        .replace('{visible}', visibleCount)
                        .replace('{total}', total)
                        .replace('{total_plural}', total === 1 ? '' : 's');
                    
                    elements.resultsFilters.textContent = state.search
                        ? uiTexts[currentLang].search_active
                            .replace('{search}', state.search)
                            .replace('{filter_text}', tagDescription)
                        : tagDescription;

                    elements.clear.disabled = state.tags.size === 0 && state.search.length === 0 && state.sort === "featured";
                }

                function updateUITexts() {
                    if (!uiTexts) return;
                    
                    const texts = uiTexts[currentLang];
                    document.getElementById('page-title').textContent = texts.page_title;
                    document.getElementById('projects-title').textContent = texts.page_title;
                    document.getElementById('projects-description').textContent = texts.page_description;
                    document.getElementById('search-label').textContent = texts.search_placeholder.split(' ')[0];
                    document.getElementById('search-input').placeholder = texts.search_placeholder;
                    document.getElementById('sort-label').textContent = texts.sort_by;
                    document.getElementById('sort-featured').textContent = texts.sort_featured;
                    document.getElementById('sort-newest').textContent = texts.sort_newest;
                    document.getElementById('sort-title').textContent = texts.sort_title;
                    document.getElementById('tag-filter-label').textContent = texts.filter_by_tag;
                    document.getElementById('clear-filters').textContent = texts.clear_filters;
                    document.getElementById('back-button-text').textContent = texts.back_to_home;
                }

                function render() {
                    elements.search.value = state.search;
                    elements.sort.value = state.sort;
                    updateUITexts();
                    buildTagFilters();
                    renderProjects();
                }

                function showProjectDetail(project) {
                    const modal = document.getElementById('project-modal');
                    const modalTitle = document.getElementById('modal-title');
                    const modalContent = document.getElementById('modal-content');
                    const projectContent = project.content[currentLang] || project.content['en-GB'];
                    
                    // Set modal title
                    modalTitle.textContent = projectContent.title;
                    
                    // Build modal content
                    const repoLink = project.external ? project.link : `https://github.com/ffarps/${project.id}`;
                    const viewRepoText = currentLang === 'pt-PT' ? 'Ver Repositório' : 'View Repo';
                    const backToProjectsText = currentLang === 'pt-PT' ? 'Voltar para todos os projetos' : 'Return to all projects';
                    const backToIndexText = currentLang === 'pt-PT' ? 'Voltar ao início' : 'Return to index';
                    
                    modalContent.innerHTML = `
                        <div class="modal-section">
                            <p>${projectContent.description}</p>
                        </div>
                        
                        <div class="modal-section">
                            <h3>${projectContent.technologies_title}</h3>
                            <ul class="modal-list">
                                ${projectContent.technologies.map(tech => `<li>${tech}</li>`).join('')}
                            </ul>
                        </div>
                        
                        <div class="modal-section">
                            <h3>${projectContent.features_title}</h3>
                            <ul class="modal-list">
                                ${projectContent.features.map(feature => `<li>${feature}</li>`).join('')}
                            </ul>
                        </div>
                        
                        <div class="modal-section">
                            <h3>${projectContent.results_title}</h3>
                            <p>${projectContent.results}</p>
                        </div>
                        
                        <div class="modal-actions">
                            <a href="/pages/projects.html" class="modal-btn">${backToProjectsText}</a>
                            <a href="/" class="modal-btn">${backToIndexText}</a>
                            <a href="${repoLink}" target="_blank" rel="noopener noreferrer" class="modal-btn primary">${viewRepoText}</a>
                        </div>
                    `;
                    
                    // Show modal
                    modal.classList.add('active');
                    document.body.style.overflow = 'hidden'; // Prevent background scrolling
                }
                
                function closeModal() {
                    const modal = document.getElementById('project-modal');
                    modal.classList.remove('active');
                    document.body.style.overflow = ''; // Restore scrolling
                }
                
                // Modal event listeners
                document.getElementById('modal-close').addEventListener('click', closeModal);
                
                // Close modal when clicking overlay
                document.getElementById('project-modal').addEventListener('click', (e) => {
                    if (e.target === e.currentTarget) {
                        closeModal();
                    }
                });
                
                // Close modal with Escape key
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && document.getElementById('project-modal').classList.contains('active')) {
                        closeModal();
                    }
                });

                // Listen for language changes
                document.addEventListener('languageChanged', () => {
                    currentLang = localStorage.getItem('lang') || 'en-GB';
                    document.getElementById('html-root').setAttribute('lang', currentLang);
                    render();
                });

                elements.search.addEventListener("input", handleSearch);
                elements.sort.addEventListener("change", handleSort);
                elements.clear.addEventListener("click", clearFilters);

                render();
            }
        });
    </script>
    <script src="/scripts/language.js"></script>
    <script src="/scripts/theme.js"></script>
</body>

</html>